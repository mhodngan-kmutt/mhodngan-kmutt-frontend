---
import { getProjects } from '@/lib/api';
import BigCard from '@/components/common/previewCard/BigCard';
import { ArrowRightIcon } from 'lucide-react';

const { t, lang } = Astro.props;
const PAGE_SIZE = 3;
const ORDER_BY = 'like_count';
const ORDER = 'desc';
const BADGE = 'Thesis';

const { meta, data: projects } = await getProjects({
  badge: BADGE,
  pageSize: PAGE_SIZE,
  orderBy: ORDER_BY,
  order: ORDER,
});
---

<section id="ThesisSection" class="flex w-full flex-col gap-5 py-6 px-16 pt-10 pb-5">
  <!-- Topic -->
  <div class="flex flex-col items-center gap-2 text-center">
    <p>{t('home.thesis.smallTopic')}</p>
    <h1>{t('home.thesis.topic')}</h1>
    <div class="lead">{t('home.thesis.subTopic')}</div>
  </div>

  <!-- List of Cards -->
  <div class="flex flex-wrap gap-6 justify-center">
    {
      projects.map((p) => (
          <BigCard
            client:load
            projectImage={p.previewImageUrl}
            title={p.title}
            explanation={p.shortDescription}
            likes={p.likeCount}
            views={p.viewCount}
            professors={p.certifiedBy}
            contributors={p.contributors}
            link={`/${lang}/project/${p.projectId}`}
            projectId={p.projectId}
            certified={t('card.certified')}
            contributorsLabel={t('card.contributors')}
          />
        ))
    }
  </div>

  <!-- Explore More -->
  <div class="flex justify-center items-center gap-5 mt-6">
    <p>{t('home.thesis.viewAll')}</p>
    <a href={`/${lang}/project?badge=${BADGE}&orderBy=${ORDER_BY}&order=${ORDER}`}>
      <button class="btn-icon" type="button" aria-label={t('home.thesis.navigate')}>
        <ArrowRightIcon size={20} />
        <span class="small">{t('home.thesis.navigate')}</span>
      </button>
    </a>
  </div>
</section>
